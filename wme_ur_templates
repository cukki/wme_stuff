// ==UserScript==
// @name         WME UR Response Templates
// @namespace    https://greasyfork.org/users/your-username
// @version      1.0
// @description  Quick response templates for Waze UR in multiple languages
// @author       Cuki
// @match        https://www.waze.com/editor*
// @match        https://www.waze.com/*/editor*
// @grant        none
// ==/UserScript==

(function() {
    'use strict';

    const TEMPLATES = {
        HU: "Szia, milyen problÃ©mÃ¡val talÃ¡lkoztÃ¡l? Ãrd meg kÃ©rlek. Ha vÃ©letlen volt a jelentÃ©s, jelezd vissza, hogy lezÃ¡rhassuk. Ãœdv: Attila",
        EN: "Hello, What problem did you encounter at the marked location? If this report is a mistake, please confirm so we can close the report. Thanks, Attila",
        DE: "Hallo, welches Problem hast du an der markierten Stelle festgestellt? Falls diese Meldung ein Versehen war, bestÃ¤tige dies bitte kurz, damit wir den Bericht schlieÃŸen kÃ¶nnen. Danke, Attila",
        CZ: "Ahoj, jakÃ½ problÃ©m jsi zaznamenal na oznaÄenÃ©m mÃ­stÄ›? Pokud bylo toto hlÃ¡Å¡enÃ­ omylem, prosÃ­m, potvrÄ to, abychom mohli zprÃ¡vu uzavÅ™Ã­t. DÃ­ky, Attila",
        PL: "CzeÅ›Ä‡, jaki problem napotkaÅ‚eÅ› w oznaczonym miejscu? JeÅ›li ten raport byÅ‚ pomyÅ‚kÄ…, potwierdÅº to, proszÄ™, abyÅ›my mogli zamknÄ…Ä‡ zgÅ‚oszenie. DziÄ™ki, Attila",
        SK: "Ahoj, akÃ½ problÃ©m si zaznamenal na oznaÄenom mieste? Ak bolo toto hlÃ¡senie omylom, prosÃ­m, potvrÄ to, aby sme mohli sprÃ¡vu uzavrieÅ¥. DÃ­ky, Attila",
        SLO: "Å½ivjo, kakÅ¡en problem si opazil na oznaÄenem mestu? ÄŒe je bilo to poroÄilo pomotoma, prosim, potrdi, da ga lahko zapremo. Hvala, Attila",
        NL: "Hallo, welk probleem heb je op de gemarkeerde locatie vastgesteld? Als dit rapport een vergissing was, bevestig dit dan even, zodat we het rapport kunnen sluiten. Bedankt, Attila",
        RO: "Salut, ce problemÄƒ ai Ã®ntÃ¢mpinat la locaÈ›ia marcatÄƒ? DacÄƒ acest raport a fost o greÈ™ealÄƒ, te rog sÄƒ confirmi, ca sÄƒ putem Ã®nchide raportul. MulÈ›umesc, Attila",
        SR: "Ğ—Ğ´Ñ€Ğ°Ğ²Ğ¾ Ğ’Ğ°Ğ·ĞµÑ€, Ğ¨Ñ‚Ğ° Ñ˜Ğµ Ñ‚Ğ°Ñ‡Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼ Ğ¾Ğ²Ğ´Ğµ Ğ´Ğ° Ğ±Ğ¸ÑĞ¼Ğ¾ Ğ³Ğ° Ñ€ĞµÑˆĞ¸Ğ»Ğ¸? ĞĞºĞ¾ Ñ˜Ğµ Ğ¿Ñ€Ğ¸Ñ˜Ğ°Ğ²Ğ° ÑĞ»ÑƒÑ‡Ğ°Ñ˜Ğ½Ğ°, Ğ¿Ğ¾Ñ‚Ğ²Ñ€Ğ´Ğ¸Ñ‚Ğµ Ğ´Ğ° Ğ±Ğ¸ÑĞ¼Ğ¾ Ğ¼Ğ¾Ğ³Ğ»Ğ¸ Ğ´Ğ° Ğ·Ğ°Ñ‚Ğ²Ğ¾Ñ€Ğ¸Ğ¼Ğ¾ Ğ¸Ğ·Ğ²ĞµÑˆÑ‚Ğ°Ñ˜. Ğ¥Ğ²Ğ°Ğ»Ğ°",
        DK: "Hej, hvilket problem stÃ¸dte du pÃ¥ ved det markerede sted? Hvis denne indberetning var en fejl, mÃ¥ du meget gerne bekrÃ¦fte det, sÃ¥ vi kan lukke rapporten. Tak, Attila"
    };

    const LANGUAGE_NAMES = {
        HU: "ğŸ‡­ğŸ‡º Magyar",
        EN: "ğŸ‡¬ğŸ‡§ English",
        DE: "ğŸ‡©ğŸ‡ª Deutsch",
        CZ: "ğŸ‡¨ğŸ‡¿ ÄŒeÅ¡tina",
        PL: "ğŸ‡µğŸ‡± Polski",
        SK: "ğŸ‡¸ğŸ‡° SlovenÄina",
        SLO: "ğŸ‡¸ğŸ‡® SlovenÅ¡Äina",
        NL: "ğŸ‡³ğŸ‡± Nederlands",
        RO: "ğŸ‡·ğŸ‡´ RomÃ¢nÄƒ",
        SR: "ğŸ‡·ğŸ‡¸ Ğ¡Ñ€Ğ¿ÑĞºĞ¸",
        DK: "ğŸ‡©ğŸ‡° Dansk"
    };

    // Create panel HTML
    const panelHTML = `
        <div id="ur-templates-panel" style="
            position: fixed;
            top: 100px;
            right: 20px;
            width: 400px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 9999;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        ">
            <div id="ur-templates-header" style="
                background: rgba(0,0,0,0.2);
                padding: 12px 15px;
                cursor: move;
                display: flex;
                justify-content: space-between;
                align-items: center;
            ">
                <span style="color: white; font-weight: bold; font-size: 14px;">ğŸ“ UR Response Templates</span>
                <div>
                    <button id="ur-templates-minimize" style="
                        background: rgba(255,255,255,0.2);
                        border: none;
                        color: white;
                        width: 24px;
                        height: 24px;
                        border-radius: 4px;
                        cursor: pointer;
                        margin-right: 5px;
                        font-weight: bold;
                    ">_</button>
                    <button id="ur-templates-close" style="
                        background: rgba(255,255,255,0.2);
                        border: none;
                        color: white;
                        width: 24px;
                        height: 24px;
                        border-radius: 4px;
                        cursor: pointer;
                        font-weight: bold;
                    ">Ã—</button>
                </div>
            </div>
            <div id="ur-templates-content" style="padding: 15px;">
                <div style="margin-bottom: 12px;">
                    <label style="color: white; font-size: 12px; display: block; margin-bottom: 5px;">Select Language:</label>
                    <select id="ur-language-select" style="
                        width: 100%;
                        padding: 8px;
                        border: none;
                        border-radius: 6px;
                        background: white;
                        font-size: 13px;
                        cursor: pointer;
                    ">
                        ${Object.keys(TEMPLATES).map(lang =>
                            `<option value="${lang}">${LANGUAGE_NAMES[lang]}</option>`
                        ).join('')}
                    </select>
                </div>
                <div style="margin-bottom: 12px;">
                    <textarea id="ur-template-text" readonly style="
                        width: 100%;
                        height: 120px;
                        padding: 10px;
                        border: none;
                        border-radius: 6px;
                        resize: vertical;
                        font-size: 13px;
                        line-height: 1.5;
                        box-sizing: border-box;
                    ">${TEMPLATES.HU}</textarea>
                </div>
                <button id="ur-copy-btn" style="
                    width: 100%;
                    padding: 10px;
                    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                    border: none;
                    border-radius: 6px;
                    color: white;
                    font-weight: bold;
                    cursor: pointer;
                    font-size: 13px;
                    transition: all 0.3s;
                ">ğŸ“‹ Copy to Clipboard</button>
            </div>
        </div>
    `;

    // Wait for page to load
    function init() {
        if (document.getElementById('ur-templates-panel')) return;

        document.body.insertAdjacentHTML('beforeend', panelHTML);

        const panel = document.getElementById('ur-templates-panel');
        const header = document.getElementById('ur-templates-header');
        const content = document.getElementById('ur-templates-content');
        const languageSelect = document.getElementById('ur-language-select');
        const templateText = document.getElementById('ur-template-text');
        const copyBtn = document.getElementById('ur-copy-btn');
        const minimizeBtn = document.getElementById('ur-templates-minimize');
        const closeBtn = document.getElementById('ur-templates-close');

        // Language change handler
        languageSelect.addEventListener('change', function() {
            templateText.value = TEMPLATES[this.value];
        });

        // Copy button handler
        copyBtn.addEventListener('click', function() {
            templateText.select();
            document.execCommand('copy');

            const originalText = copyBtn.innerHTML;
            copyBtn.innerHTML = 'âœ… Copied!';
            copyBtn.style.background = 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)';

            setTimeout(() => {
                copyBtn.innerHTML = originalText;
                copyBtn.style.background = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
            }, 1500);
        });

        // Minimize handler
        let isMinimized = false;
        minimizeBtn.addEventListener('click', function() {
            isMinimized = !isMinimized;
            content.style.display = isMinimized ? 'none' : 'block';
            minimizeBtn.innerHTML = isMinimized ? 'â–¡' : '_';
        });

        // Close handler
        closeBtn.addEventListener('click', function() {
            panel.style.display = 'none';
        });

        // Make draggable
        let isDragging = false;
        let currentX;
        let currentY;
        let initialX;
        let initialY;

        header.addEventListener('mousedown', dragStart);
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', dragEnd);

        function dragStart(e) {
            initialX = e.clientX - panel.offsetLeft;
            initialY = e.clientY - panel.offsetTop;
            isDragging = true;
        }

        function drag(e) {
            if (isDragging) {
                e.preventDefault();
                currentX = e.clientX - initialX;
                currentY = e.clientY - initialY;
                panel.style.left = currentX + 'px';
                panel.style.top = currentY + 'px';
                panel.style.right = 'auto';
            }
        }

        function dragEnd() {
            isDragging = false;
        }
    }

    // Initialize when WME is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        setTimeout(init, 1000);
    }
})();
